<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Locomotive Scroll + GSAP ScrollTrigger</title>
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%; overflow: hidden;
      font-family: Arial, sans-serif;
    }
    #js-scroll {
      overflow: hidden;
    }
    section {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 2rem;
      padding: 2rem;
    }
    section:nth-child(odd) {
      background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
    }
    h1, h2, p {
      margin: 20px;
    }
  </style>
</head>
<body>

  <div id="js-scroll" data-scroll-container>
    <section data-scroll-section>
      <h1 data-scroll data-scroll-speed="1" class="animate">Hola mundo</h1>
      <p data-scroll data-scroll-speed="2" class="animate">Este texto tiene scroll suave y parallax.</p>
    </section>
    <section data-scroll-section>
      <h2 data-scroll data-scroll-speed="-1" class="animate">Otra sección</h2>
      <p class="animate">Aquí animamos con GSAP y ScrollTrigger.</p>
    </section>
  </div>

  <!-- Locomotive Scroll -->
  <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>
  <!-- GSAP core -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
  <!-- GSAP ScrollTrigger plugin -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/ScrollTrigger.min.js"></script>

  <script>
    // Inicializar Locomotive Scroll
    const scroll = new LocomotiveScroll({
      el: document.querySelector('#js-scroll'),
      smooth: true,
      smartphone: { smooth: true },
      tablet: { smooth: true }
    });

    // Actualizar ScrollTrigger cuando Locomotive Scroll actualice el scroll
    scroll.on('scroll', ScrollTrigger.update);

    // Conectar ScrollTrigger con Locomotive Scroll (para que GSAP detecte el scroll correctamente)
    ScrollTrigger.scrollerProxy('#js-scroll', {
      scrollTop(value) {
        return arguments.length ? scroll.scrollTo(value, 0, 0) : scroll.scroll.instance.scroll.y;
      },
      getBoundingClientRect() {
        return { top: 0, left: 0, width: window.innerWidth, height: window.innerHeight };
      },
      // Esto es para evitar que ScrollTrigger intente escuchar eventos nativos que Locomotive Scroll no usa
      pinType: document.querySelector('#js-scroll').style.transform ? "transform" : "fixed"
    });

    // Refrescar ScrollTrigger y Locomotive Scroll al redimensionar la ventana
    ScrollTrigger.addEventListener('refresh', () => scroll.update());
    ScrollTrigger.refresh();

    // Animaciones GSAP con ScrollTrigger usando el contenedor personalizado
    gsap.utils.toArray('.animate').forEach(elem => {
      gsap.from(elem, {
        scrollTrigger: {
          trigger: elem,
          scroller: '#js-scroll',
          start: 'top 80%',
          end: 'bottom 60%',
          toggleActions: 'play none none reverse',
          // markers: true // descomenta para ver los marcadores en pantalla
        },
        opacity: 0,
        y: 50,
        duration: 1,
        ease: 'power2.out'
      });
    });
  </script>

</body>
</html>
